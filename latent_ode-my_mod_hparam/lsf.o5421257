Lmod has detected the following error: The following module(s) are unknown:
"pytorch/1.4.0" "cuda/10.0.13"

Please check the spelling or version number. Also try "module spider ..."
It is also possible your cache file is out-of-date; it may help to try:
  $ module --ignore-cache load "pytorch/1.4.0" "cuda/10.0.13"



/cluster/work/igp_psr/metzgern/ODEcrop/latent_ode-my_mod/run_models.py
run_models.py --niters 80 -n 300000 -b 500 -l 35 --dataset crop --ode-rnn --rec-dims 100 --rec-layers 4 --gen-layers 1 --units 500 --gru-units 50 --classif --ode-method adams --random-seed 6002
  0%|          | 0/46080 [00:00<?, ?it/s]  0%|          | 1/46080 [00:01<14:49:59,  1.16s/it]  0%|          | 2/46080 [00:02<13:47:36,  1.08s/it]  0%|          | 3/46080 [00:03<13:49:58,  1.08s/it]  0%|          | 4/46080 [00:04<15:49:12,  1.24s/it]  0%|          | 5/46080 [00:05<15:53:33,  1.24s/it]  0%|          | 6/46080 [00:07<16:17:22,  1.27s/it]  0%|          | 7/46080 [00:08<16:59:56,  1.33s/it]  0%|          | 8/46080 [00:10<17:31:10,  1.37s/it]  0%|          | 9/46080 [00:11<17:30:23,  1.37s/it]  0%|          | 10/46080 [00:13<17:39:24,  1.38s/it]  0%|          | 11/46080 [00:14<17:56:41,  1.40s/it]  0%|          | 12/46080 [00:15<17:49:33,  1.39s/it]  0%|          | 13/46080 [00:17<17:33:56,  1.37s/it]  0%|          | 14/46080 [00:18<18:01:18,  1.41s/it]  0%|          | 15/46080 [00:19<17:09:00,  1.34s/it]  0%|          | 16/46080 [00:21<16:42:38,  1.31s/it]  0%|          | 17/46080 [00:22<16:09:16,  1.26s/it]  0%|          | 18/46080 [00:23<16:09:31,  1.26s/it]  0%|          | 19/46080 [00:25<17:32:33,  1.37s/it]  0%|          | 20/46080 [00:26<16:56:47,  1.32s/it]  0%|          | 21/46080 [00:27<16:21:12,  1.28s/it]  0%|          | 22/46080 [00:28<15:59:09,  1.25s/it]  0%|          | 23/46080 [00:29<15:37:42,  1.22s/it]  0%|          | 24/46080 [00:31<15:22:17,  1.20s/it]  0%|          | 25/46080 [00:32<15:17:50,  1.20s/it]  0%|          | 26/46080 [00:33<15:15:29,  1.19s/it]  0%|          | 27/46080 [00:34<15:24:40,  1.20s/it]  0%|          | 28/46080 [00:35<15:55:24,  1.24s/it]  0%|          | 29/46080 [00:37<15:47:45,  1.23s/it]  0%|          | 30/46080 [00:38<16:25:47,  1.28s/it]  0%|          | 31/46080 [00:39<16:31:17,  1.29s/it]  0%|          | 32/46080 [00:41<16:40:54,  1.30s/it]  0%|          | 33/46080 [00:42<16:16:02,  1.27s/it]  0%|          | 34/46080 [00:43<16:43:38,  1.31s/it]  0%|          | 35/46080 [00:45<16:23:03,  1.28s/it]  0%|          | 36/46080 [00:46<16:13:07,  1.27s/it]  0%|          | 37/46080 [00:47<16:15:11,  1.27s/it]  0%|          | 38/46080 [00:48<16:30:40,  1.29s/it]  0%|          | 39/46080 [00:50<17:49:06,  1.39s/it]  0%|          | 40/46080 [00:51<18:13:48,  1.43s/it]  0%|          | 41/46080 [00:53<17:39:42,  1.38s/it]  0%|          | 42/46080 [00:54<16:55:58,  1.32s/it]  0%|          | 43/46080 [00:55<17:00:58,  1.33s/it]  0%|          | 44/46080 [00:57<16:55:58,  1.32s/it]  0%|          | 45/46080 [00:58<16:49:52,  1.32s/it]  0%|          | 46/46080 [00:59<16:53:13,  1.32s/it]  0%|          | 47/46080 [01:01<17:02:28,  1.33s/it]  0%|          | 48/46080 [01:02<17:12:49,  1.35s/it]  0%|          | 49/46080 [01:03<17:05:21,  1.34s/it]  0%|          | 50/46080 [01:04<16:33:15,  1.29s/it]  0%|          | 51/46080 [01:06<15:50:01,  1.24s/it]  0%|          | 52/46080 [01:07<15:24:39,  1.21s/it]  0%|          | 53/46080 [01:08<14:47:17,  1.16s/it]  0%|          | 54/46080 [01:09<15:00:54,  1.17s/it]  0%|          | 55/46080 [01:10<14:43:47,  1.15s/it]  0%|          | 56/46080 [01:11<14:01:55,  1.10s/it]  0%|          | 57/46080 [01:12<14:02:30,  1.10s/it]  0%|          | 58/46080 [01:13<13:56:14,  1.09s/it]Couldn't import umap
Sampling dataset of 300000 training examples

Trainingdataset:
Dataset Crops
    Number of datapoints: 287858
    Root Location: data/Crops
    Reduce: average

Using Evaluationdataset:
Dataset Crops
    Number of datapoints: 55740
    Root Location: data/Crops
    Reduce: average

label pred
tensor([[[9.7150e-01, 6.5686e-04, 1.8507e-02,  ..., 4.8723e-05,
          1.7012e-05, 2.6424e-04],
         [6.9349e-01, 2.9476e-02, 2.0283e-01,  ..., 1.5980e-03,
          4.9032e-04, 4.2611e-03],
         [7.6633e-03, 8.0660e-05, 5.4441e-03,  ..., 2.3997e-04,
          4.2306e-05, 2.6062e-06],
         ...,
         [1.6741e-01, 6.0131e-01, 3.8860e-02,  ..., 3.3544e-02,
          5.7628e-03, 4.2355e-02],
         [1.6364e-01, 5.5377e-01, 5.9685e-02,  ..., 3.6772e-02,
          6.5488e-03, 3.4626e-02],
         [9.1276e-01, 4.6680e-03, 6.8450e-02,  ..., 1.5193e-04,
          5.2214e-05, 9.2345e-04]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
labels
tensor([[1.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [1.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.1111, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        ...,
        [0.0000, 1.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 1.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [1.0000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]],
       device='cuda:0')
Traceback (most recent call last):
  File "run_models.py", line 295, in <module>
    train_res = model.compute_all_losses(batch_dict, n_traj_samples = 3, kl_coef = kl_coef)
  File "/cluster/work/igp_psr/metzgern/ODEcrop/latent_ode-my_mod/lib/base_models.py", line 169, in compute_all_losses
    raise Exception("CE loss is Nan!")
Exception: CE loss is Nan!
  0%|          | 58/46080 [01:14<16:24:25,  1.28s/it]
